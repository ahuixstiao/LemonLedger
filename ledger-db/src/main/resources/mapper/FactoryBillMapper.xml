<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ledger.db.mapper.FactoryBillMapper">

    <!-- 查询工厂账单集合 -->
    <select id="selectFactoryBillList" resultType="factoryBillDto">

        select fb.id,
        fb.factory_id,
        ft.factory_name,
        fb.number,
        fb.style_number,
        fb.category_id,
        jc.category,
        fb.quantity,
        fb.bill
        from factory_bill fb
        left join factory ft on fb.factory_id = ft.id
        left join job_category jc on fb.category_id = jc.id
        where fb.flag = #{flag}
        <!-- 如果传入工厂ID则按工厂ID查询 -->
        <if test="factoryId != null and factoryId != '' ">
            and fb.factory_id = #{factoryId}
        </if>
        <!-- 如果传入床号则按床号查询 -->
        <if test="number != null and number != '' ">
            and fb.number = #{number}
        </if>
        <!-- 如果传入款式编号则按款式编号查询 -->
        <if test="styleNumber != null and styleNumber != '' ">
            and fb.style_number = #{styleNumber}
        </if>
        <!-- 如果传入工作类型ID则按工作类型ID查询 -->
        <if test="categoryId != null and categoryId != '' ">
            and fb.category_id = #{categoryId}
        </if>
        order by ft.factory_name desc
    </select>


</mapper>
